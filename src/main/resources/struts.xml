<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC "-//Apache Software Foundation//DTD Struts Configuration 2.1//EN" "http://struts.apache.org/dtds/struts-2.1.dtd">
<struts>
	<constant name="struts.enable.DynamicMethodInvocation" value="false" />
	<constant name="struts.devMode" value="false" />
	<constant name="struts.xslt.nocache" value="true" />
	<constant name="struts.action.excludePattern" value="/ajax/.*,/ajax/test/.*" />
	<constant name="struts.action.extension" value="action" />
	<constant name="struts.multipart.maxSize" value="15485760" />
	<constant name="struts.multipart.saveDir" value="/home/hdfs/tss/run/storage/upload" />
	<constant name="struts.objectFactory" value="spring" />
	<!-- 默认 -->
	<package name="default" namespace="/" extends="struts-default,json-default">
		<global-results>
			<result name="error">/WEB-INF/jsp/common/exception.jsp</result>
			<result name="success">/WEB-INF/jsp/common/message.jsp</result>
			<result name="message">/WEB-INF/jsp/common/message.jsp</result>
			<result name="lossUser">/login.jsp</result>
		</global-results>
		<global-exception-mappings>
			<exception-mapping exception="java.lang.Exception" result="error" />
		</global-exception-mappings>
	</package>
	<!-- 系统中charts 定义 -->
	<package name="charts" namespace="/charts" extends="struts-default,json-default">
		<action name="chartsView.*" class="ChartsViewAction" method="{1}">
			<result name="success">/WEB-INF/jsp/common/message.jsp</result>
			<result name="highChartsColumn">/plugins/charts/highChartsColumn.jsp</result>
			<result name="highChartsPie">/plugins/charts/highChartsPie.jsp</result>
			<result name="eventConfirmEChart">/plugins/charts/eventConfirmCharts.jsp</result>
			<result name="eventDealEChart">/plugins/charts/eventDealCharts.jsp</result>
			<result name="eventDealFormECharts">/plugins/charts/eventDealFormCharts.jsp</result>
			<result name="eventDealDocumentECharts">/plugins/charts/eventDealDocumentCharts.jsp</result>
		</action>
		<action name="chartsData.*" class="chartsDataAction" method="{1}" />
	</package>
	<!-- 系统管理与共公功能 -->
	<package name="application" namespace="/application" extends="default">
		<!-- 系统功能 -->
		<action name="application.*" class="ApplicationAction" method="{1}">
			<result name="success">/WEB-INF/jsp/common/message.jsp</result>
			<result name="downloadFile" type="chain">
				<param name="actionName">download.downExistResource</param>
				<param name="namespace">/application</param>
			</result>
		</action>
		<action name="appJob.*" class="AppJobAction" method="{1}">
			<result name="success">/WEB-INF/jsp/common/message.jsp</result>
		</action>
		<action name="applicationView.*" class="ApplicationViewAction" method="{1}">
			<result name="success">/WEB-INF/jsp/common/message.jsp</result>
			<result name="systemEnvView">/WEB-INF/jsp/sysman/systemEnv.jsp</result>
			<result name="upgradeRecordView">/WEB-INF/jsp/sysman/upgradeRecordView.jsp</result>
			<result name="quartzCronView">/WEB-INF/jsp/sysman/quartzCronView.jsp</result>
			<result name="backupView">/WEB-INF/jsp/sysman/backup.jsp</result>
			<result name="backupConfigurationView">/WEB-INF/jsp/sysman/backupConfiguration.jsp</result>
			<result name="loopholeEventConfirmView">/WEB-INF/jsp/event/loopholeEventConfirmView.jsp</result>
			<result name="tableDataMonitorView">/WEB-INF/jsp/sysman/tableDataMonitor.jsp</result>
			<result name="moduleMonitorView">/WEB-INF/jsp/sysman/moduleMonitorView.jsp</result>
			<result name="cacheFlushView">/WEB-INF/jsp/sysman/cacheFlush.jsp</result>
			<result name="showAllMenuView">/WEB-INF/jsp/sysman/showAllMenuView.jsp</result>
			<result name="versionView">/WEB-INF/jsp/sysman/version.jsp</result>
		</action>
		<action name="frameView.*" class="FrameViewAction" method="{1}">
			<result name="content">/WEB-INF/jsp/frame/content.jsp</result>
			<result name="eventContent">/WEB-INF/jsp/frame/eventContent.jsp</result>
			<result name="eventContentTree">/WEB-INF/jsp/frame/eventContentTree.jsp</result>
			<result name="contentThreeSplitFrameView">/WEB-INF/jsp/frame/contentThreeSplitFrameView.jsp</result>
			<result name="censusContent">/WEB-INF/jsp/frame/censusContent.jsp</result>
		</action>
		<!-- 资源下载功能 -->
		<action name="download.*" class="FileDownLoadAction" method="{1}">
			<result name="downloadFile" type="chain">
				<param name="actionName">download.downExistResource</param>
				<param name="namespace">/application</param>
			</result>
		</action>
		<!-- 数据同步 -->
		<action name="exportDataSynch.*" class="ExportDataSynchAction" method="{1}">
			<result name="dataExport">/WEB-INF/jsp/sysman/synch/synchExport.jsp</result>
			<result name="downloadFile" type="chain">
				<param name="actionName">download.downExistResource</param>
				<param name="namespace">/application</param>
			</result>
		</action>
		<action name="importDataSynch.*" class="ImportDataSynchAction" method="{1}">
			<result name="uploadSynchFile">/WEB-INF/jsp/sysman/synch/synchImport.jsp</result>
		</action>
		<!-- TSS-DMS子系统 -->
		<action name="tssDmsView.*" class="TssDmsViewAction" method="{1}">
			<result name="success">/WEB-INF/jsp/common/message.jsp</result>
		</action>
	</package>
	<!-- 菜单控制 -->
	<package name="menu" namespace="/menu" extends="struts-default,json-default">
		<!-- 二级菜单导导航树 -->
		<action name="navData.*" class="NavDataAction" method="{1}" />
		<action name="dataTables.*" class="DataTablesAction" method="{1}" />
		<action name="toolBar.*" class="ToolBarAction" method="{1}" />
	</package>
	<!-- PORTAL -->
	<package name="portal" namespace="/portal" extends="struts-default,json-default">
		<!-- portal ctrl -->
		<action name="portal.*" class="PortalAction" method="{1}" />
		<action name="portalView.*" class="PortalViewAction" method="{1}">
			<result name="eventHistoryAnalysis">/WEB-INF/jsp/portal/eventHistoryAnalysis.jsp</result>
			<result name="eventDealAnalysis">/WEB-INF/jsp/portal/eventDealAnalysis.jsp</result>
			<result name="securityEventAnalysis">/WEB-INF/jsp/portal/portal.jsp</result>
			<result name="eventGdAnalysis">/WEB-INF/jsp/portal/eventGdAnalysis.jsp</result>
		</action>
	</package>
	<!-- 权限与权限管理 -->
	<package name="authorize" namespace="/authorize" extends="struts-default,json-default">
		<!-- 登录 -->
		<action name="authentication.login" class="AuthenticationAction" method="login">
			<result name="changeUserPassword" type="chain">
				<param name="actionName">authorizeView.changeUserPasswordView</param>
				<param name="namespace">/authorize</param>
			</result>
			<result name="index" type="redirect">/index.jsp</result>
			<result name="error">/login.jsp</result>
		</action>
		<!-- 登出 -->
		<action name="authentication.logout" class="AuthenticationAction" method="logout">
			<result name="success" type="redirect">/login.jsp</result>
		</action>
		<!-- 授权，权限管理处理ACTION -->
		<action name="authorize.*" class="AuthorizeAction" method="{1}">
			<result name="success">/WEB-INF/jsp/common/message.jsp</result>
			<result name="error">/WEB-INF/jsp/common/message.jsp</result>
			<result name="login">/login.jsp</result>
		</action>
		<!-- 授权，权限管理处理ACTION -->
		<action name="authorizeView.*" class="AuthorizeViewAction" method="{1}">
			<result name="success">/WEB-INF/jsp/common/message.jsp</result>
			<result name="error">/WEB-INF/jsp/common/message.jsp</result>
			<result name="authorizeTree">/WEB-INF/jsp/authorize/autPermissionTree.jsp</result>
			<result name="changeUserPassword">/WEB-INF/jsp/authorize/changeUserPassword.jsp</result>
			<result name="updateCurrentUserDetail">/WEB-INF/jsp/authorize/updateCurrentUserDetail.jsp</result>
			<result name="currentUserDetail">/WEB-INF/jsp/authorize/currentUserDetail.jsp</result>
		</action>
	</package>
	<!--资源管理模块 -->
	<package name="resource" namespace="/resource" extends="struts-default,json-default">
		<!-- 资源对象处理 -->
		<action name="resource.*" class="ResourceAction" method="{1}">
			<result name="success">/WEB-INF/jsp/common/message.jsp</result>
			<result name="error">/WEB-INF/jsp/common/message.jsp</result>
			<result name="downloadFile" type="chain">
				<param name="actionName">download.downExistResource</param>
				<param name="namespace">/application</param>
			</result>
			<result name="importResource">/WEB-INF/jsp/resource/import/resourceImport.jsp</result>
		</action>
		<action name="importResource.*" class="ImportResourceAction" method="{1}">
			<result name="importResource">/WEB-INF/jsp/resource/import/resourceImport.jsp</result>
			<result name="importResourceBacth">/WEB-INF/jsp/resource/import/resourceImportBatch.jsp</result>
			<result name="importIpSegment">/WEB-INF/jsp/resource/import/importIpSegment.jsp</result>
			<result name="downloadFile" type="chain">
				<param name="actionName">download.downExistResource</param>
				<param name="namespace">/application</param>
			</result>
		</action>
		<!-- 资源对象视图支持 -->
		<action name="resourceView.*" class="ResourceViewAction" method="{1}">
			<result name="success">/WEB-INF/jsp/common/message.jsp</result>
			<result name="error">/WEB-INF/jsp/common/message.jsp</result>
			<result name="resourceDatail">/WEB-INF/jsp/resource/resourceDetail.jsp</result>
			<result name="resourceSave">/WEB-INF/jsp/resource/resourceSave.jsp</result>
			<result name="subView">/WEB-INF/jsp/resource/subpage/subView.jsp</result>
			<result name="lookupDnsIps">/WEB-INF/jsp/resource/subpage/lookupDnsIps.jsp</result>
			<result name="lookupCorpoartionContacts">/WEB-INF/jsp/resource/subpage/lookupCorpoartionContacts.jsp</result>
			<result name="resourceView">/WEB-INF/jsp/resource/resourceView.jsp</result>
			<result name="uploadResourceView">/WEB-INF/jsp/resource/uploadResourceView.jsp</result>
			<result name="importResourceUploadView">/WEB-INF/jsp/resource/import/resourceImportUpload.jsp</result>
			<result name="importResourceUploadModuleView">/WEB-INF/jsp/resource/import/resourceImportUploadModule.jsp</result>
			<result name="resCorporationDetail">/WEB-INF/jsp/resource/resCorporationDetail.jsp</result>
			<result name="sseSpecialTopicSaveView">/WEB-INF/jsp/resource/sseSpecialTopicSaveView.jsp</result>
			<result name="subTableDetailView">/WEB-INF/jsp/resource/subpage/subTableDetailView.jsp</result>
			<result name="appJobSaveView">/WEB-INF/jsp/resource/appJobSaveView.jsp</result>
			<result name="sseSpecialSortView">/WEB-INF/jsp/resource/sseSpecialSortView.jsp</result>
			<result name="importExcelUploadView">/WEB-INF/jsp/resource/import/excelImportUpload.jsp</result>
		</action>
		<!-- 关系对象处理 -->
		<action name="relation.*" class="RelationAction" method="{1}">
			<result name="success">/WEB-INF/jsp/common/message.jsp</result>
			<result name="error">/WEB-INF/jsp/common/message.jsp</result>
		</action>
	</package>
	<!-- 考核处理 -->
	<!-- 考核处理 -->
	<package name="assessment" namespace="/assessment" extends="struts-default,json-default,default">
		<action name="assessmentView.*" class="AssessmentViewAction" method="{1}">
			<result name="dataView">/WEB-INF/jsp/assessment/dataView.jsp</result>
			<result name="dataUpdateView">/WEB-INF/jsp/assessment/dataUpdateView.jsp</result>
			<result name="dataUpdateWeeklyView">/WEB-INF/jsp/assessment/dataUpdateWeeklyView.jsp</result>
		</action>
	</package>
	<!-- 考核处理 -->
	<!-- 通报文档处理 -->
	<package name="report" namespace="/report" extends="struts-default,json-default">
		<action name="documentView.*" class="documentViewAction" method="{1}">
			<result name="reviewDocView">/WEB-INF/jsp/report/reviewDocView.jsp</result>
			<result name="documentPublishView">/WEB-INF/jsp/report/documentPublishView.jsp</result>
			<result name="publishAndSendView">/WEB-INF/jsp/report/publishAndSendView.jsp</result>
			<result name="success">/WEB-INF/jsp/common/message.jsp</result>
			<result name="error">/WEB-INF/jsp/common/message.jsp</result>
		</action>
		<action name="documentCtrl.*" class="documentCtrlAction" method="{1}">
			<result name="documentView">/WEB-INF/jsp/report/documentView.jsp</result>
			<result name="success">/WEB-INF/jsp/common/message.jsp</result>
			<result name="error">/WEB-INF/jsp/common/message.jsp</result>
			<result name="downloadFile" type="chain">
				<param name="actionName">download.downExistResource</param>
				<param name="namespace">/application</param>
			</result>
		</action>
	</package>
	<!-- 通报文档处理 -->
	<!-- 安全事件处理 -->
	<package name="event" namespace="/event" extends="struts-default,json-default">
		<!-- 安全事件对象处置 -->
		<action name="dealEvent.*" class="DealEventAction" method="{1}">
			<result name="success">/WEB-INF/jsp/common/message.jsp</result>
			<result name="error">/WEB-INF/jsp/common/message.jsp</result>
			<result name="downloadFile" type="chain">
				<param name="actionName">download.downExistResource</param>
				<param name="namespace">/application</param>
			</result>
		</action>
		<action name="historyEvent.*" class="HistoryEventAction" method="{1}">
			<result name="success">/WEB-INF/jsp/common/message.jsp</result>
			<result name="error">/WEB-INF/jsp/common/message.jsp</result>
			<result name="downloadFile" type="chain">
				<param name="actionName">download.downExistResource</param>
				<param name="namespace">/application</param>
			</result>
			<result name="historyDetailView">/WEB-INF/jsp/event/historyDetailView.jsp</result>
			<result name="historyEventDealFormView">/WEB-INF/jsp/event/historyEventDealFormView.jsp</result>
		</action>
		<!-- 安全事件视图支持 -->
		<action name="dealEventView.*" class="DealEventViewAction" method="{1}">
			<result name="dealEventView">/WEB-INF/jsp/event/dealEventView.jsp</result>
			<result name="dealFormView">/WEB-INF/jsp/event/dealFormView.jsp</result>
			<result name="eventConfirmView">/WEB-INF/jsp/event/confirmView.jsp</result>
			<result name="backDoorEventConfirmView">/WEB-INF/jsp/event/backDoorEventConfirmView.jsp</result>
			<result name="dealView">/WEB-INF/jsp/event/dealView.jsp</result>
			<result name="detailView">/WEB-INF/jsp/event/detailView.jsp</result>
			<result name="lookupFormEventView">/WEB-INF/jsp/event/lookupEventView.jsp</result>
			<result name="reBackView">/WEB-INF/jsp/event/reBackView.jsp</result>
			<result name="uploadResultView">/WEB-INF/jsp/event/uploadResultView.jsp</result>
			<result name="feedBackEventUploadView">/WEB-INF/jsp/event/uploadEventView.jsp</result>
			<result name="error">/WEB-INF/jsp/common/message.jsp</result>
			<result name="loopholeEventConfirmView">/WEB-INF/jsp/event/loopholeEventConfirmView.jsp</result>
			<result name="appendEventOtherFieldView">/WEB-INF/jsp/event/appendEventOtherFieldView.jsp</result>
			<result name="attackDataDetailView">/WEB-INF/jsp/event/attackDataDetailView.jsp</result>
			<result name="loopHoleScoreView">/WEB-INF/jsp/event/loopHoleScoreView.jsp</result>
			<result name="lookDocView">/WEB-INF/jsp/event/lookDocView.jsp</result>
			<result name="formPublishView">/WEB-INF/jsp/event/formPublishView.jsp</result>
		</action>
		<!-- 安全事件导航树视图支持 -->
		<action name="eventGuideTree.*" class="EventGuideTreeAction" method="{1}" />
	</package>
	<!-- 服务统计视图 -->
	<package name="census" namespace="/census" extends="struts-default,json-default">
		<action name="censusView.*" class="CensusViewAction" method="{1}">
			<result name="corporationDefaultChart">/WEB-INF/jsp/census/corporationView.jsp</result>
			<result name="specialTopicDefaultChart">/WEB-INF/jsp/census/specialTopicView.jsp</result>
			<result name="extDataNetFlowPortocolAnalyze">/WEB-INF/jsp/census/extDataNetFlowPortocolAnalyze.jsp</result>
			<result name="sseTotalMonthlyAnalyze">/WEB-INF/jsp/census/sseTotalMonthlyAnalyze.jsp</result>
		</action>
		<action name="census.*" class="CensusAction" method="{1}">
			<result name="corporationDefaultChart">/WEB-INF/jsp/common/message.jsp</result>
		</action>
	</package>
	<!-- 监测事件/数据管理 -->
	<package name="monitor" namespace="/monitor" extends="struts-default,json-default">
		<action name="monitorEventView.*" class="monitorEventViewAction" method="{1}">
			<result name="bugEventUpload">/WEB-INF/jsp/monitor/bugEventUpload.jsp</result>
			<result name="generalEventUpload">/WEB-INF/jsp/monitor/generalEventUpload.jsp</result>
			<result name="tree">/WEB-INF/jsp/tree/tree.jsp</result>
			<result name="error">/WEB-INF/jsp/common/message.jsp</result>
		</action>
		<action name="monitorEventCtrl.*" class="monitorEventAction" method="{1}">
			<result name="bugEvent">/WEB-INF/jsp/monitor/bugEvent.jsp</result>
			<result name="generalEvent">/WEB-INF/jsp/monitor/generalEvent.jsp</result>
			<result name="error">/WEB-INF/jsp/common/message.jsp</result>
		</action>
	</package>
</struts>